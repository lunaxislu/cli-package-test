#!/usr/bin/env node
import{Command as O}from"commander";import g from"path";import u from"fs-extra";function l(){let e=g.join("package.json");return u.readJSONSync(e)}async function y(e){let o=g.join(e,"package.json");return u.readJSON(o)}function h(){let e=l(),o=e.dependencies||{},n=e.devDependencies||{},s={...o,...n},m=!!s.react,a=!!s.next,r=!0;return!m&&!a&&(r=!1),r}import p from"path";import{detect as R}from"@antfu/ni";import T from"fast-glob";var $=["**/node_modules/**",".next","public","dist","build"];async function P(e){let o=await R({programmatic:!0,cwd:e});return console.log(o),o==="yarn@berry"?"yarn":o==="pnpm@6"?"pnpm":o==="bun"?"bun":o??"npm"}async function k(e){return(await T.glob("tsconfig.*",{cwd:e,deep:1,ignore:$})).length>0}import t from"kleur";import v from"fs-extra";import{execa as N}from"execa";async function J(e){let o=await fetch(e);if(!o.ok)throw new Error(`Failed to fetch ${e}: ${o.statusText}`);return await o.text()}async function j(e,o){console.log(t.cyan("Installing...."));let n=process.cwd(),s=p.resolve(n,"src"),m=p.resolve(s,"components"),a=p.resolve(m,"ui");try{let[r,d,c]=await Promise.all([P(n),y(n),k(n)]),G=d.dependencies||{},C=d.devDependencies||{};if(!h())throw new Error(t.red(`This project is not a React or Next.js project.
Please use this CLI in a React or Next.js project.`));let b=c?"tsx":"jsx",F=c?"typescript":"javascript";console.log(t.blue(`Project type: ${c?"TypeScript":"JavaScript"}. Using .${b} files.`)),await v.mkdir(a,{recursive:!0});let S=o[F].files;for(let i of S){let I=await J(i.path),f=p.join(a,i.name);await v.writeFile(f,I),console.log(t.green(`Copied ${i.name} to ${f}`))}if(c&&!C["@types/css-modules"]){console.log(t.yellow("@types/css-modules is not installed. Installing..."));try{await N(r,[r==="npm"?"install":"add","@types/css-modules","--save-dev"],{cwd:n,stdio:"inherit"}),console.log(t.green("@types/css-modules has been installed successfully."))}catch(i){console.log(t.red("Failed to `${projectPackageManager===npm ? install :add} @types/cs-mdoules"),i)}}console.log(t.green(`Created folders: ${a}`))}catch(r){console.error(t.red("Failed to copy components or install @types/node:"),r)}}import _ from"fs-extra";import w from"path";import{fileURLToPath as D}from"url";var E=D(import.meta.url),M=w.dirname(E);function x(){let e=w.resolve(M,"component.json");return _.readJSONSync(e)}function V(){let e=l(),o=x(),n=new O;n.name("cli-button").description("add components to your project").version(e.version||"1.0.0","-v, --version","display the version number").command("add <button>").action(s=>j(s,o)),n.parse()}V();
//# sourceMappingURL=index.mjs.map